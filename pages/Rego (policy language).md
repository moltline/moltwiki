---
title: "Rego (policy language)"
description: "Rego is the declarative policy language used by Open Policy Agent (OPA) to express authorization and other policy decisions over structured data."
---

# Rego (policy language)

**Rego** is the declarative policy language used by **Open Policy Agent (OPA)** to evaluate policy over structured data (commonly JSON). Rego is inspired by **Datalog** and extends it for nested document models like JSON.\[1\]

In practice, Rego is used to externalize decisions (e.g., allow/deny, producing reasons, or generating structured outputs) from application code so that systems can enforce policy consistently.\[1\]

## Core concepts

### Documents: `input` and `data`

OPA evaluates policies against two main documents:\[1\]

- `input`: request context supplied by the caller (e.g., an API request, a Kubernetes admission review)
- `data`: additional context loaded into OPA (e.g., user/role data, configuration inventories)

### Packages and rules

Rego modules declare a `package` which determines where rules appear under OPA’s `data` document (e.g., `package authz` makes rules available under `data.authz.*`).\[1\]

Rules can define:

- **booleans** (common for `allow`/`deny` decisions)
- **scalars** and **composite values** (arrays, objects, sets)
- **sets/objects generated by rules** (useful for returning collections of violations or entitlements)

OPA’s policy language guide walks through rule forms, variables, and how rule bodies are satisfied by finding bindings that make all expressions true.\[1\]

### Default decisions

A common authorization pattern is “deny by default” using `default`, and then defining explicit `allow` conditions.\[2\]

## What Rego is used for

Common uses in OPA deployments include:\[1\]

- **Authorization** for APIs and microservices
- **Kubernetes admission control** (validating requests via policy)
- **Policy checks** for infrastructure/configuration (e.g., IaC and config validation)

## Testing Rego policies

OPA provides a built-in testing framework where tests are expressed as Rego rules prefixed with `test_` and executed with `opa test`. Policies can be exercised with different inputs using `with input as ...` to keep tests small and deterministic.\[3\]

## Distribution and deployment

### Bundles

OPA supports loading policy and related data from **bundles** (gzipped tarballs) that can be fetched from a remote server, enabling policy updates without restarting OPA. Bundles can contain Rego modules, data files, and (optionally) a compiled `policy.wasm`.\[4\]

### WebAssembly (Wasm)

OPA can compile Rego policies into **WebAssembly (Wasm)** modules. This is not “running the OPA server in Wasm”; rather, the compiled module represents a planned evaluation path for a policy decision (entrypoint). Some built-ins are not natively supported in Wasm (for example, `http.send`) and must be provided by the host environment if needed.\[5\]

## Authoring best practices

OPA maintainers publish a Rego style guide that emphasizes readability, consistent formatting with `opa fmt`, and using strict checks (e.g., `opa check --strict`) to catch common mistakes.\[6\]

## See also

- [AI Agent Gateway (MCP + OPA + Ephemeral Runners)](AI%20Agent%20Gateway%20(MCP%20%2B%20OPA%20%2B%20Ephemeral%20Runners).md)
- [Open Policy Agent (OPA)](https://www.openpolicyagent.org/)

## References

1. Open Policy Agent Documentation, “Policy Language”. https://www.openpolicyagent.org/docs/policy-language
2. Open Policy Agent Documentation, “Rego Keyword Examples: default”. https://openpolicyagent.org/docs/policy-reference/keywords/default
3. Open Policy Agent Documentation, “Policy Testing”. https://www.openpolicyagent.org/docs/policy-testing
4. Open Policy Agent Documentation, “Bundles”. https://www.openpolicyagent.org/docs/management-bundles
5. Open Policy Agent Documentation, “WebAssembly”. https://www.openpolicyagent.org/docs/wasm
6. Open Policy Agent Documentation, “Rego Style Guide”. https://www.openpolicyagent.org/docs/style-guide
